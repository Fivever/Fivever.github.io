---
layout: post
title: 图模型
date: 2019-03-24
categories: 模式识别与机器学习
tag: 读书笔记
published: true
---

## 贝叶斯网络

首先考虑三变量上的任意联合概率分布p(a,b,c)，我们可以写成

<img src="https://latex.codecogs.com/png.latex?p(a,b,c)=p(c\mid a,b)p(a,b)">

再次使用乘法规则得到

<img src="https://latex.codecogs.com/png.latex?p(a,b,c)=p(c\mid a,b)p(b\mid a)p(a)">

这个分解方法对于任意的联合概率分布的选择都成立。现在我们用一个简单的图模型表示上述方程，对于因子<img src="https://latex.codecogs.com/png.latex?p(c\mid a,b)">会存在从结点a,b到结点c的链接，以此类推，得到a,b,c的转移矩阵为

<img src="https://latex.codecogs.com/png.latex?\begin{pmatrix}&space;0&1&1\\&space;0&0&1\\&space;0&0&0&space;\end{pmatrix}">

现在将上述例子拓展到K个变量的联合概率分布<img src="https://latex.codecogs.com/png.latex?p(x_1,...,x_K)">，通过重复使用乘积规则，联合概率分布可以写为

<img src="https://latex.codecogs.com/png.latex?p(x_1,...,x_K)=p(x_K\mid x_1,...,x_{K-1})...p(x_2\mid x_1)p(x_1)">

对应一个给定的K，我们可以将其表示为一个具有K个结点的有向图，并且这个图是全连接的。

我们现在说明给定的有向图和变量上对应的概率分布之间的一般关系。在图的所有结点上定义的联合概率分布由每个结点上的条件概率分布的乘积表示，每个条件概率分布的条件都是图中结点的父结点所对应的变量，因此，对于一个有K个结点的图，联合概率为

<img src="https://latex.codecogs.com/png.latex?p(x)=\prod_{k=1}^Kp(x_k\mid pa_k)

其中，<img src="https://latex.codecogs.com/png.latex?pa_k">表示<img src="https://latex.codecogs.com/png.latex?x_k">的父结点的集合，<img src="https://latex.codecogs.com/png.latex?x=\{x_1,...,x_k\}">。这个关键的方程表示有向图模型的联合概率分布的分解属性。我们考虑的有向图要满足一个重要的限制，即不能存在有向环，即为有向无环图（DAG)。这等价于存在一个将各点的排序，使得不存在从某个结点到序号较小的结点的链接。

## 例子：多项式回归

这个模型中的随机变量是多项式系数向量<img src="https://latex.codecogs.com/png.latex?\omega">和观测数据<img src="https://latex.codecogs.com/png.latex?t=(t_1,...,t_N)^T">。此外，这个模型包括输入数据<img src="https://latex.codecogs.com/png.latex?x=(x_1,...,x_N)^T">、噪声方差<img src="https://latex.codecogs.com/png.latex?\sigma^2">，以及表示<img src="https://latex.codecogs.com/png.latex?\omega">的高斯先验分布的精度的超参数<img src="https://latex.codecogs.com/png.latex?\alpha">。所有这些都是模型的参数而不是随机变量。因为联合概率等于先验概率<img src="https://latex.codecogs.com/png.latex?p(\omega)">和N个条件概率分布<img src="https://latex.codecogs.com/png.latex?p(t_n\mid \omega)">的乘积（N=1,...,N)，即

<img src="https://latex.codecogs.com/png.latex?p(t,\omega)=p(\omega)\prod^N_{n=1}p(t_n\mid \omega)">

当我们处理更加复杂的模型时，显式的写出<img src="https://latex.codecogs.com/png.latex?t_1,...t_N">是很不方便的。于是引入一种图结构，使得多个结点可以更简洁地表示出来，画出一个单一表示的结点<img src="https://latex.codecogs.com/png.latex?t_n">，然后用一个称作板(plate)的框标记为N，表示有N个同类型的点。显式的写出模型的参数和随机变量是很有帮助的。

<img src="https://latex.codecogs.com/png.latex?p(t,\omega\mid x,\alpha,\sigma^2)=p(\omega\mid \alpha)\prod^N_{n=1}p(t_n\mid \omega,x_n,\sigma^2)">

随机变量用空心圆表示，确定性参数由小的实心圆表示，给对应的结点加上阴影表示观测变量