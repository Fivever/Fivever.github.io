---
layout: post
title: 高级加密标准（AES）
date: 2019-04-25
categories: 密码学
tag: 读书笔记
---

*content
{:toc}

## 有限域

域是一个可以在其上进行加法、减法、乘法和除法运算而结果不会超出域的集合。如有理数集合、实数集合、复数集合都是域，但整数集合不是（很明显，使用除法得到的分数或小数已超出整数集合）。

如果域F只包含有限个元素，则称其为有限域。有限域中元素的个数称为有限域的阶。尽管存在有无限个元素的无限域，但只有有限域在密码编码学中得到了广泛的应用。每个有限域的阶必为素数的幂，即有限域的阶可表示为pⁿ（p是素数、n是正整数），该有限域通常称为Galois域(Galois Fields)，记为GF(pⁿ)。

### 建立GF(2^2)

令Z_2[x]是系数为整数模2的多项式，例如X^6+X+1。我们在多项式上做加减乘法也需要系数模2。例如乘法(X^3+X+1)(X+1)=X^4+X^3+X^2+1，除法(X^4+X^3+1)=(X^2+1)(X^2+X+1)+X\Rightarrow X^4+X^3+1 \equiv X(mod\ X^2+X+1)。

因此我们定义Z_2[x](mod\ X^2+X+1)为集合\{0,1,X,X+1\}。对于模X^2+X+1的加乘除法，实际上构成了4个元素的有限域。

### 建立有限域GF(p^n)

1. Z_p[x]是系数为模p的多项书集合。
2. 选择一个系数为模p（系数模p），度为n（最高次为n）的既约多项式（不可约多项式）P(X)
3. 令GF(p^n)为Z_p[x]mod\ P(X)，则GF(p^n)是有p^n个元素的有限域。

### 拓展欧几里德算法

扩展欧几里得算法（英语：Extended Euclidean algorithm）是欧几里得算法（又叫辗转相除法）的扩展。已知整数a、b，扩展欧几里得算法可以在求得a、b的最大公约数的同时，能找到整数x、y（其中一个很可能是负数），使它们满足贝祖等式

ax+by=gcd(a,b)

#### 例1

用类似辗转相除法，求二元一次不定方程47x+30y=1的整数解。

  47=30*1+17

  30=17*1+13

  17=13*1+4

  13=4*3+1

- 然后把它们改写成“余数等于”的形式


  7=47*1+30*(-1) //式1

  13=30*1+17*(-1) //式2

  4=17*1+13*(-1) //式3

  1=13*1+4*(-3)

- 然后把它们“倒回去”

  1=13*1+4*(-3)

  1=13*1+[17*1+13*(-1)]*(-3) //应用式3

  1=17*(-3)+13*4

  1=17*(-3)+[30*1+17*(-1)]*4//应用式2

  1=30*4+17*(-7)

  1=30*4+[47*1+30*(-1)]*(-7) //应用式1

  1=47*(-7)+30*11

- 得解x=-7,y=11。

#### 例2

考虑GF(2^8)=Z_2[X](mod\ X^8+X^4+X^3+X+1)，找到X^7+X^6+X^3+X+1的逆元。

X^8+X^4+X^3+X+1=(X+1)(X^7+X^6+X^3+X+1)+(X^6+X^2+X)

X^7+X^6+X^3+X+1=(X+1)(X^6+X^2+X)+1

因此1=(X^2)(X^7+X^6+X^3+X+1)+(X+1)(X^8+X^4+X^3+X+1)，两边取模X^8+X^4+X^3+X+1得到

（X^2)(X^7+X^6+X^3+X+1)\equiv 1(mod\ X^8+X^4+X^3+X+1)

### GF(2^8)

考虑GF(2^8)=Z_2[X](mod\ X^8+X^4+X^3+X+1)，每个有限域的元都可以唯一的表示为多项式

b_7X^7+b_6X^6+b_5X^5+b_4X^4+b_3X^3+b_2X^2+b_1X+b_0

8比特b_7b_6b_5b_4b_3b_2b_1b_0可以表示为一个字节。

加法就是按比特异或：

(X^7+X^6+X^3+X+1)+(X^4+X^3+1)->11001011\oplus 00011001=11010010->X^7+X^6+X^4+X

乘法是：

(X^7+X^6+X^3+X+1)(X)->110010110->110010110\oplus 100011011->10001101->X^7+X^3+X^2+1

## 基本算法

128比特密钥加密128比特消息需要迭代10次，不同比特数迭代次数不同。

### 字节转换(The ByteSub Transformation)

这是一个非线性层主要用于防止差分和线性分析攻击

### 移动行变换(The ShiftRow Transformation)

这是一个线性层，可以导致多轮之间各个比特位间的扩散

### 混合列变换(The MixColumn Transformation)

这一层的目的与移动行变换相同

### 轮密钥加密变换(AddRoundKey)

轮密钥与上一层的结果进行异或操作