---
layout: post
title: 数据加密标准（DES）
date: 2019-04-22
categories: 密码学
tag: 读书笔记
---

* content
{:toc}

## 简化DES型算法

### 一轮Feistel系统

- 加密过程

  <img src="https://latex.codecogs.com/png.latex? L_{i}=R_{i-1}和R_i=L_{i-1}\oplus f(R_{i-1},K_i)">

  这一操作会使初始明文<img src="https://latex.codecogs.com/png.latex? L_0R_0">经过n次迭代之后成为密文<img src="https://latex.codecogs.com/png.latex? L_nR_n">。

- 解密过程

  该系统的特点是解密过程和加密过程是一样的

  1. <img src="https://latex.codecogs.com/png.latex? L_nR_n\rightarrow R_nL_n">

  2. <img src="https://latex.codecogs.com/png.latex? [R_n][L_n]=[L_{n-1}][R_{n-1}\oplus f(L_{n-1},K_n)]">

               <img src="https://latex.codecogs.com/png.latex? =[R_{n-2}][L_{n-2}\oplus f(R_{n-2},K_{n-1})\oplus f(L_{n-1},K_n)]">

               <img src="https://latex.codecogs.com/png.latex? =[R_{n-2}][L_{n-2}]">

  3. 重复步骤2，得到<img src="https://latex.codecogs.com/png.latex? R_0L_0">

  4. <img src="https://latex.codecogs.com/png.latex? R_0L_0\rightarrow L_0R_0">
  
- 函数<img src="https://latex.codecogs.com/png.latex? f(R_{i-1},K_i)">

  1. <img src="https://latex.codecogs.com/png.latex? R_{i-1}">先通过某个定义的扩张函数进行扩展

  2. 将已扩展的<img src="https://latex.codecogs.com/png.latex? R_{i-1}">与<img src="https://latex.codecogs.com/png.latex? K_i">进行异或运算

  3. 按照运算结果的分段数位，索引S-盒进行编码的压缩

## DES

DES的密钥通常写为64比特，但每8比特有一位奇偶效验位，可以忽略，因此，实际只有56比特。

DES算法的加密过程有三个阶段

1. 消息m的比特串通过一个固定初始计算得到<img src="https://latex.codecogs.com/png.latex? m_0=IP(m)">，并且写为<img src="https://latex.codecogs.com/png.latex? m_0=L_0R_0">，其中<img src="https://latex.codecogs.com/png.latex? L_0">是前32位，<img src="https://latex.codecogs.com/png.latex? R_0">是后32位。

2. 对于<img src="https://latex.codecogs.com/png.latex? 1\leqslant i\leqslant 16">，进行

  <img src="https://latex.codecogs.com/png.latex? L_{i}=R_{i-1}和R_i=L_{i-1}\oplus f(R_{i-1},K_i)">

  这里K是从密钥K中产生的一个48比特串，f是一个定义的函数

3. 调换前后次序得到<img src="https://latex.codecogs.com/png.latex? R_{16}L_{16}">，接着使用初始计算的逆得到密文<img src="https://latex.codecogs.com/png.latex? c=IP^{-1}(R_{16}L_{16})">，解密过程用到了完全相同的过程，除了密钥使用相反的次序。

### 初始计算

```
58,50,42,34,26,18,10,2,
60,52,44,36,28,20,12,4,
62,54,46,38,30,22,14,6,
64,56,48,40,32,24,16,8,
57,49,41,33,25,17,9,1,
59,51,43,35,27,19,11,3,
61,53,45,37,29,21,13,5,
63,55,47,39,31,23,15,7;
```

这是对一个序列的打乱重组，意思是转换后第一位数是原序列的第58位，前8行就是<img src="https://latex.codecogs.com/png.latex? L_0">，初始计算没有任何密码意义。

### 函数<img src="https://latex.codecogs.com/png.latex? f(R_{i-1},K_i)">

1. 按照下表将R_{i-1}（32位）拓展为E(R_{i-1})（48位）

拓展位|原序列|拓展位
32|1|2|3|4|5
4|5|6|7|8|9
8|9|10|11|12|13
12|13|14|15|16|17
16|17|18|19|20|21
20|21|22|23|24|25
24|25|26|27|28|29
28|29|30|31|32|1

### 初始计算的逆运算

```
40,8,48,16,56,24,64,32,
39,7,47,15,55,23,63,31,
38,6,46,14,54,22,62,30,
37,5,45,13,53,21,61,29,
36,4,44,12,52,20,60,28,
35,3,43,11,51,19,59,27,
34,2,42,10,50,18,58,26,
33,1,41,9,49,17,57,25;
```